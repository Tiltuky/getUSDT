# **gRPC Сервис для получения курса USDT**

Данный сервис предназначен для получения актуального курса USDT с биржи Garantex и сохранения курса в базе данных с отметкой времени.

---

## **Функционал сервиса**
- **GRPC метод `GetRates`** — получает текущий курс USDT с биржи Garantex.
- **Сохранение данных** — курс с отметкой времени сохраняется в базе данных PostgreSQL.
- **Healthcheck** — метод для проверки работоспособности сервиса.
- **Мониторинг метрик** — поддержка метрик **Prometheus** для наблюдения за состоянием приложения.
- **Трассировки**:
  - **OpenTelemetry** — для сбора и экспорта трассировок.
  - **Jaeger** — интеграция для визуализации распределенных трассировок.

---

## **Используемые технологии**
- **Go** — версия 1.22 и выше.
- **PostgreSQL** — реляционная база данных для хранения данных о курсах.
- **Goose** — инструмент для автоматизации миграций базы данных.
- **Docker** — для контейнеризации и управления зависимостями.
- **Prometheus** — для сбора метрик.
- **OpenTelemetry** — для трассировки событий.
- **Jaeger** — для визуализации и анализа трассировок.
- **GolangCI-Lint** — для статического анализа и проверки качества кода.

---

## **Требования для запуска**
- Установленная версия **Go** (не ниже 1.22).
- **Docker**.
- **GolangCI-Lint** (для проверки кода).

---

## **Инструкция по запуску**

1. **Склонируйте репозиторий:**
   ```bash
   git clone https://github.com/Tiltuky/getUSDT.git
2. **Соберите Docker-образ:**
   ```bash
   make docker-build
3. **Запустите приложение:**
   ```bash
   make start
4. **Для ручного запуска приложения используйте:**
   ```bash
   make run

---

## **Настройка**
Конфигурационные параметры подключения к базе данных, бирже и другим сервисам настраиваются в файле:
- **config/local.yaml.**

---

## **Команды Makefile**

| Команда            | Описание                                                             |
|--------------------|----------------------------------------------------------------------|
| `make build`       | Создает исполняемый файл приложения в текущем каталоге.             |
| `make test`        | Запускает unit-тесты.                                               |
| `make docker-build`| Собирает Docker-образ.                                              |
| `make start`       | Запускает все контейнеры в фоне.                                    |
| `make run`         | Запускает приложение внутри Docker-контейнера.                      |
| `make lint`        | Запускает статический анализ кода с помощью GolangCI-Lint.          |


---

## **Проверка работоспособности через Postman**
1. Создайте поле для работы с gRPC.
2. Через Service Definition загрузите .proto-файл из проекта.
3. Выберите необходимый метод (например, GetRates).
4. Укажите адрес сервиса: localhost:8000.
5. Нажмите Invoke для вызова метода.

---

## **Дополнительная информация**
- Все миграции базы данных автоматически применяются при запуске через goose.
- Логи приложения и ошибок можно найти в стандартном выводе контейнера.
- Сервис готов для интеграции с клиентскими приложениями через протокол gRPC.
